# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

name: EthicalCheck-Workflow

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  schedule:
    - cron: '26 2 * * 1'
  workflow_dispatch:

permissions:
  contents: read

jobs:
  Trigger_EthicalCheck:
    permissions:
      security-events: write
      actions: read
    runs-on: ubuntu-latest

    steps:
      - name: EthicalCheck Free & Automated API Security Testing Service
        uses: apisec-inc/ethicalcheck-action@005fac321dd843682b1af6b72f30caaf9952c641
        with:
          # CRITICAL: Replace this with your actual API specification URL.
          # This could be a URL to a file in your repo (e.g., https://your-domain.com/swagger.json)
          oas-url: "YOUR_API_SPECIFICATION_URL_HERE"
          
          # CRITICAL: Replace this with your email, preferably using a repository secret.
          # To do this, go to Settings > Secrets and variables > Actions > New repository secret
          # Name it REPORT_EMAIL and paste your email address as the value.
          email: "${{ secrets.REPORT_EMAIL }}"
          
          # This defines the name of the output file. No change needed here.
          sarif-result-file: "ethicalcheck-results.sarif"

      - name: Upload sarif file to repository
        # This step is correctly configured to upload the results file.
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: ./ethicalcheck-results.sarif
